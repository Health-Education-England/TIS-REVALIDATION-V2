<mat-toolbar>
    <mat-toolbar-row>
        <span>Third Line</span>
        <span class="spacer"></span>
        <button mat-icon-button aria-label="Watch trainee" (click)="toggleWatchTrainee()">
            <mat-icon [ngClass]="{'icon-blue': watchTrainee}">{{ watchTrainee ? 'visibility' : 'visibility_off' }}
            </mat-icon>
        </button>
        <button mat-icon-button aria-label="Add notes" (click)="openNotes()">
            <mat-icon>speaker_notes</mat-icon>
        </button>
    </mat-toolbar-row>
</mat-toolbar>
<div>
    <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">

        <ng-container matColumnDef="episodeId">
            <th mat-header-cell *matHeaderCellDef> Episode Id </th>
            <td mat-cell *matCellDef="let element"> {{ element.episodeId }} </td>
        </ng-container>
        <ng-container matColumnDef="recommendation">
            <th mat-header-cell *matHeaderCellDef> Recommendation </th>
            <td mat-cell *matCellDef="let element"> {{ element.recommendation }} </td>
        </ng-container>
        <ng-container matColumnDef="outcome">
            <th mat-header-cell *matHeaderCellDef> Outcome</th>
            <td mat-cell *matCellDef="let element">
                <div class="outcome" [ngSwitch]="element.outcome">
                    <mat-icon *ngSwitchCase="'Approved'" aria-hidden="true" class="icon-green">done_all</mat-icon>
                    <mat-icon *ngSwitchCase="'Rejected'" aria-hidden="true" class="icon-red">error_outline</mat-icon>
                    <mat-icon *ngSwitchCase="'Under review'" aria-hidden="true" class="icon-blue">done</mat-icon>
                    <span class="outcome-text">{{ element.outcome }}</span>
                </div>
            </td>
        </ng-container>
        <ng-container matColumnDef="gmcSubDueDate">
            <th mat-header-cell *matHeaderCellDef> GMC Submission Due Date </th>
            <td mat-cell *matCellDef="let element"> {{ element.gmcSubDueDate }}
            </td>
        </ng-container>
        <ng-container matColumnDef="ActSubDate">
            <th mat-header-cell *matHeaderCellDef> Actual Submission Date </th>
            <td mat-cell *matCellDef="let element"> {{ element.ActSubDate }} </td>
        </ng-container>
        <ng-container matColumnDef="submittedBy">
            <th mat-header-cell *matHeaderCellDef> Submitted By </th>
            <td mat-cell *matCellDef="let element"> {{ element.submittedBy }} </td>
        </ng-container>

        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                <div class="element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                    <div class="element-submission-status">
                        <strong>Submission Status:</strong> {{element.submissionStatus}}
                    </div>
                    <mat-divider *ngIf="element.comments?.length > 0"></mat-divider>
                    <ng-container *ngFor="let comment of element.comments">
                        <div class="element-notes">
                            {{ comment }}
                        </div>
                    </ng-container>
                </div>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr role="button" tabindex="0" mat-row *matRowDef="let element; columns: columnsToDisplay;" class="element-row"
            [class.expanded-row]="expandedElement === element"
            (click)="expandedElement = expandedElement === element ? null : element"
            (keyup.enter)="expandedElement = expandedElement === element ? null : element"
            (keyup.space)="expandedElement = expandedElement === element ? null : element">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
    </table>

    <div class="button-row">
        <span class="spacer"></span>
        <button mat-raised-button (click)="openDialog()" color="primary">Recommend</button>
    </div>

</div>