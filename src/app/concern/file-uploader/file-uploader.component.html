<!-- spinner  -->
<div *ngIf="uploadFileInProgress$ | async; else notLoading">
  <div *ngFor="let fileInProgress of filesInUploadProgress$ | async">
    <mat-card>
      <mat-card-title>
        {{ fileInProgress.file.name }}
      </mat-card-title>
      <mat-card-subtitle>
        <div class="d-flex justify-content-between">
          <span>{{ fileInProgress.file.size | fileBytes }}</span>
          <span>{{ fileInProgress.progress / 100 | percent }}</span>
        </div>
      </mat-card-subtitle>
      <mat-card-content>
        <mat-progress-bar [value]="fileInProgress.progress"></mat-progress-bar>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<ng-template #notLoading>
  <form [formGroup]="form">
    <div
      class="button-row upload centered p-20"
      #dropArea
      (dragenter)="preventDefaults($event); highlight()"
      (dragover)="preventDefaults($event); highlight()"
      (dragleave)="preventDefaults($event); unHighlight()"
      (drop)="preventDefaults($event); unHighlight(); handleDrop($event)"
    >
      <p>
        Drag and drop supporting documents, or click attach icon to upload:
      </p>
      <button
        mat-button
        color="accent"
        mat-mini-fab
        (click)="fileUploader.click()"
      >
        <mat-icon>attachment</mat-icon>
      </button>
      <input
        hidden
        type="file"
        #fileUploader
        multiple
        [formControlName]="'fileUploader'"
        [accept]="acceptedFileTypes"
        (change)="onFilesSelection($event)"
      />
      <p class="mat-caption">
        Supported files include: Images (.png. jpg), PDF, Word (.doc .docx) and
        excel (.xlxs .xls). Max file size
        <strong>{{ acceptedFileSize | fileBytes }}</strong>
      </p>
    </div>
  </form>
</ng-template>
